var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r,n=(e,a)=>{for(var l in a||(a={}))t.call(a,l)&&s(e,l,a[l]);if(r)for(var l of r(a))o.call(a,l)&&s(e,l,a[l]);return e},u=(e,r)=>a(e,l(r)),i=(e,a,l)=>new Promise(((r,t)=>{var o=e=>{try{n(l.next(e))}catch(a){t(a)}},s=e=>{try{n(l.throw(e))}catch(a){t(a)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);n((l=l.apply(e,a)).next())}));import{u as p,_ as d,a as c,b as m,A as g}from"./useCheckedColumns-v-zj8hRk.js";import{c as f,U as b,_ as v}from"./index-CicZAoMs.js";/* empty css                */import{_ as h}from"./ArtTable-FR9-jzWh.js";/* empty css                    */import{A as y,R as _}from"./formData-BKeWWDhs.js";import{k as j,r as P,a2 as C,e as V,S as k,t as w,y as x,z as O,x as S,i as z,u as U,b2 as R,P as T,T as A,m as I,I as q,J as E,aT as L,b3 as N,a6 as B,a3 as D,a4 as G,L as F,ad as J,ae as K,E as Q,_ as W,b4 as $,aw as H}from"./vendor-DaJLkETo.js";import"./formEnum-BLgiZVxV.js";import"./vue-draggable-plus-Bmv50ij4.js";/* empty css               *//* empty css               *//* empty css                       *//* empty css                       *//* empty css                   *//* empty css                 */import"./avatar9-oKrDyQhv.js";const M={class:"account-page",id:"table-full-screen"},X={class:"dialog-footer"},Y=v(j(u(n({},{name:"User"}),{__name:"index",setup(e){const{width:a}=f(),l=P("add"),r=P(!1),t=P(!1),o={name:"",phone:"",address:"",level:"",email:"",date:"",daterange:"",status:"1"},s=P([]),v=C(n({},o)),j=C({currentPage:1,pageSize:20,total:0}),Y=P([]),Z=P(),ee=P([]),ae=()=>{Object.assign(v,n({},o)),j.currentPage=1,de()},le=()=>{j.currentPage=1,de()},re=e=>{},te=[{label:"用户名",prop:"name",type:"input",config:{clearable:!0},onChange:re},{label:"电话",prop:"phone",type:"input",config:{clearable:!0},onChange:re},{label:"用户等级",prop:"level",type:"select",config:{clearable:!0},options:()=>[{label:"普通用户",value:"normal"},{label:"VIP用户",value:"vip"},{label:"高级VIP",value:"svip"},{label:"企业用户",value:"enterprise",disabled:!0}],onChange:re},{label:"地址",prop:"address",type:"input",config:{clearable:!0},onChange:re},{label:"邮箱",prop:"email",type:"input",config:{clearable:!0},onChange:re},{prop:"date",label:"日期",type:"date",config:{type:"date",placeholder:"请选择日期"}},{prop:"daterange",label:"日期范围",type:"daterange",config:{type:"daterange",startPlaceholder:"开始时间",endPlaceholder:"结束时间"}},{label:"状态",prop:"status",type:"radio",options:[{label:"在线",value:"1"},{label:"离线",value:"2"}],onChange:re}],oe=e=>{switch(e){case"1":return"success";case"2":default:return"info";case"3":return"warning";case"4":return"danger"}},se=(e,a)=>{r.value=!0,l.value=e,ie.value&&ie.value.resetFields(),"edit"===e&&a?(pe.username=a.username,pe.phone=a.userPhone,pe.gender=1===a.gender?"男":"女",pe.role=Array.isArray(a.userRoles)?a.userRoles:[]):(pe.username="",pe.phone="",pe.gender="男",pe.role=[])},{columnChecks:ne,columns:ue}=p((()=>[{type:"selection"},{prop:"avatar",label:"用户名",minWidth:a.value<500?220:"",formatter:e=>W("div",{class:"user",style:"display: flex; align-items: center"},[W("img",{class:"avatar",src:e.avatar}),W("div",{},[W("p",{class:"user-name"},e.userName),W("p",{class:"email"},e.userEmail)])])},{prop:"userGender",label:"性别",sortable:!0,formatter:e=>1===e.userGender?"男":"女"},{prop:"userPhone",label:"手机号"},{prop:"status",label:"状态",formatter:e=>W($,{type:oe(e.status)},(()=>(e=>{let a="";return"1"===e?a="在线":"2"===e?a="离线":"3"===e?a="异常":"4"===e&&(a="注销"),a})(e.status)))},{prop:"createTime",label:"创建日期",sortable:!0},{prop:"operation",label:"操作",width:150,formatter:e=>W("div",[W(g,{type:"edit",onClick:()=>se("edit",e)}),W(g,{type:"delete",onClick:()=>{H.confirm("确定要注销该用户吗？","注销用户",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((()=>{Q.success("注销成功")}))}})])}])),ie=P(),pe=C({username:"",phone:"",gender:"",role:[]});V((()=>{de(),ce()}));const de=()=>i(this,null,(function*(){t.value=!0;try{const{currentPage:e,pageSize:a}=j,{records:l,current:r,size:t,total:o}=yield b.getUserList({current:e,size:a});Y.value=l.map(((e,a)=>u(n({},e),{avatar:y[a%y.length].avatar}))),Object.assign(j,{currentPage:r,pageSize:t,total:o})}catch(e){}finally{t.value=!1}})),ce=()=>{s.value=_},me=()=>{de()},ge=e=>{ee.value=e},fe=C({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号格式",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]}),be=()=>i(this,null,(function*(){ie.value&&(yield ie.value.validate((e=>{e&&(Q.success("add"===l.value?"添加成功":"更新成功"),r.value=!1)})))})),ve=e=>{j.pageSize=e,de()},he=e=>{j.currentPage=e,de()};return(e,a)=>{const o=d,n=T,u=c,i=L,p=h,g=F,f=G,b=K,y=J,_=D,P=R,C=m;return w(),k(C,null,{default:x((()=>[O("div",M,[S(o,{filter:U(v),"onUpdate:filter":a[0]||(a[0]=e=>z(v)?v.value=e:null),items:te,onReset:ae,onSearch:le},null,8,["filter"]),S(P,{shadow:"never",class:"art-table-card"},{default:x((()=>[S(u,{columns:U(ne),"onUpdate:columns":a[2]||(a[2]=e=>z(ne)?ne.value=e:null),onRefresh:me},{left:x((()=>[S(n,{onClick:a[1]||(a[1]=e=>se("add"))},{default:x((()=>a[9]||(a[9]=[A("新增用户")]))),_:1,__:[9]})])),_:1},8,["columns"]),S(p,{ref_key:"tableRef",ref:Z,"row-key":"id",loading:U(t),data:U(Y),currentPage:U(j).currentPage,pageSize:U(j).pageSize,total:U(j).total,marginTop:10,onSelectionChange:ge,onSizeChange:ve,onCurrentChange:he},{default:x((()=>[(w(!0),I(q,null,E(U(ue),(e=>(w(),k(i,N({key:e.prop||e.type},{ref_for:!0},e),null,16)))),128))])),_:1},8,["loading","data","currentPage","pageSize","total"]),S(U(B),{modelValue:U(r),"onUpdate:modelValue":a[8]||(a[8]=e=>z(r)?r.value=e:null),title:"add"===U(l)?"添加用户":"编辑用户",width:"30%","align-center":""},{footer:x((()=>[O("div",X,[S(n,{onClick:a[7]||(a[7]=e=>r.value=!1)},{default:x((()=>a[10]||(a[10]=[A("取消")]))),_:1,__:[10]}),S(n,{type:"primary",onClick:be},{default:x((()=>a[11]||(a[11]=[A("提交")]))),_:1,__:[11]})])])),default:x((()=>[S(_,{ref_key:"formRef",ref:ie,model:U(pe),rules:U(fe),"label-width":"80px"},{default:x((()=>[S(f,{label:"用户名",prop:"username"},{default:x((()=>[S(g,{modelValue:U(pe).username,"onUpdate:modelValue":a[3]||(a[3]=e=>U(pe).username=e)},null,8,["modelValue"])])),_:1}),S(f,{label:"手机号",prop:"phone"},{default:x((()=>[S(g,{modelValue:U(pe).phone,"onUpdate:modelValue":a[4]||(a[4]=e=>U(pe).phone=e)},null,8,["modelValue"])])),_:1}),S(f,{label:"性别",prop:"gender"},{default:x((()=>[S(y,{modelValue:U(pe).gender,"onUpdate:modelValue":a[5]||(a[5]=e=>U(pe).gender=e)},{default:x((()=>[S(b,{label:"男",value:"男"}),S(b,{label:"女",value:"女"})])),_:1},8,["modelValue"])])),_:1}),S(f,{label:"角色",prop:"role"},{default:x((()=>[S(y,{modelValue:U(pe).role,"onUpdate:modelValue":a[6]||(a[6]=e=>U(pe).role=e),multiple:""},{default:x((()=>[(w(!0),I(q,null,E(U(s),(e=>(w(),k(b,{key:e.roleCode,value:e.roleCode,label:e.roleName},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])),_:1})])])),_:1})}}})),[["__scopeId","data-v-e50ef918"]]);export{Y as default};
