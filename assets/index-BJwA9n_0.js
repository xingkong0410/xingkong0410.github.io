var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,r=(e,a)=>{for(var l in a||(a={}))u.call(a,l)&&o(e,l,a[l]);if(t)for(var l of t(a))n.call(a,l)&&o(e,l,a[l]);return e},i=(e,a,l)=>new Promise(((t,u)=>{var n=e=>{try{r(l.next(e))}catch(a){u(a)}},o=e=>{try{r(l.throw(e))}catch(a){u(a)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,o);r((l=l.apply(e,a)).next())}));import{u as s,_ as d,a as m,b as p,A as c}from"./useCheckedColumns-EyIHKUTh.js";import{i as f,b as h,B as b,I as v,C as _,_ as g}from"./index-63odVBlA.js";/* empty css                */import{_ as y}from"./index-QsDknLA0.js";/* empty css               *//* empty css               *//* empty css                       *//* empty css                        */import{_ as k}from"./ArtTable-BQucUL5n.js";/* empty css                    */import{al as V,s as w,k as j,r as C,a2 as x,e as L,c as O,D as U,S as I,t as A,y as E,z as T,x as H,i as N,u as P,b2 as S,O as B,P as M,T as D,G as q,m as R,I as z,J as F,aT as J,b3 as K,a6 as W,a3 as $,v as G,a4 as X,aX as Z,aW as Q,aL as Y,aJ as ee,L as ae,ac as le,ab as te,E as ue,n as ne,_ as oe,b4 as re,as as ie,aw as se}from"./vendor-DaJLkETo.js";import"./formEnum-BLgiZVxV.js";import"./vue-draggable-plus-Bmv50ij4.js";/* empty css                       */import"./iconfont-DPUoc2h2.js";/* empty css                   *//* empty css                 */const de=h(),me={class:"menu-page",id:"table-full-screen"},pe={class:"dialog-footer"};var ce;const fe=g(j((ce=r({},{name:"Menus"}),a(ce,l({__name:"index",setup(e){const{hasAuth:a}=(()=>{var e,a;const l=V(),{isFrontendMode:t}=f(),{info:u}=w(de),n=null!=(a=null==(e=u.value)?void 0:e.buttons)?a:[],o=Array.isArray(l.meta.authList)?l.meta.authList:[];return{hasAuth:e=>t.value?n.includes(e):o.some((a=>(null==a?void 0:a.auth_mark)===e))}})(),{menuList:l}=w(b()),t=C(!1),u={name:"",route:""},n=x(r({},u)),o=x(r({},u)),h=()=>{Object.assign(n,r({},u)),Object.assign(o,r({},u)),we()},g=()=>{Object.assign(o,r({},n)),we()},j=[{label:"菜单名称",prop:"name",type:"input",config:{clearable:!0}},{label:"路由地址",prop:"route",type:"input",config:{clearable:!0}}],ce=e=>{var a,l,t;return e.children&&e.children.length>0?"info":(null==(a=e.meta)?void 0:a.link)&&(null==(l=e.meta)?void 0:l.isIframe)?"success":e.path?"primary":(null==(t=e.meta)?void 0:t.link)?"warning":void 0},{columnChecks:fe,columns:he}=s((()=>[{prop:"meta.title",label:"菜单名称",minWidth:120,formatter:e=>{var a;return _(null==(a=e.meta)?void 0:a.title)}},{prop:"type",label:"菜单类型",formatter:e=>oe(re,{type:ce(e)},(()=>(e=>{var a,l,t;return e.children&&e.children.length>0?"目录":(null==(a=e.meta)?void 0:a.link)&&(null==(l=e.meta)?void 0:l.isIframe)?"内嵌":e.path?"菜单":(null==(t=e.meta)?void 0:t.link)?"外链":void 0})(e)))},{prop:"path",label:"路由",formatter:e=>{var a;return(null==(a=e.meta)?void 0:a.link)||e.path||""}},{prop:"meta.authList",label:"可操作权限",formatter:e=>{var a;return oe("div",{},null==(a=e.meta.authList)?void 0:a.map(((e,a)=>oe(ie,{placement:"top-start",title:"操作",width:200,trigger:"click",key:a},{default:()=>oe("div",{style:"margin: 0; text-align: right"},[oe(M,{size:"small",type:"primary",onClick:()=>Ae("button",e)},{default:()=>"编辑"}),oe(M,{size:"small",type:"danger",onClick:()=>He()},{default:()=>"删除"})]),reference:()=>oe(M,{class:"small-btn"},{default:()=>e.title})}))))}},{prop:"date",label:"编辑时间",formatter:()=>"2022-3-12 12:00:00"},{prop:"status",label:"隐藏菜单",formatter:e=>oe(re,{type:e.meta.isHide?"danger":"info"},(()=>e.meta.isHide?"是":"否"))},{prop:"operation",label:"操作",width:180,formatter:e=>oe("div",[a("B_CODE1")&&oe(c,{type:"add",onClick:()=>Ae("menu")}),a("B_CODE2")&&oe(c,{type:"edit",onClick:()=>Oe("edit",e)}),a("B_CODE3")&&oe(c,{type:"delete",onClick:()=>Te()}),a("add")&&oe(c,{type:"add",onClick:()=>Ae("menu")}),a("edit")&&oe(c,{type:"edit",onClick:()=>Oe("edit",e)}),a("delete")&&oe(c,{type:"delete",onClick:()=>Te()})])}])),be=()=>{we()},ve=C(!1),_e=x({name:"",path:"",label:"",icon:"",isEnable:!0,sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1}),ge=C(v.UNICODE),ye=C("menu"),ke=x({name:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],path:[{required:!0,message:"请输入路由地址",trigger:"blur"}],label:[{required:!0,message:"输入权限标识",trigger:"blur"}],authName:[{required:!0,message:"请输入权限名称",trigger:"blur"}],authLabel:[{required:!0,message:"请输入权限权限标识",trigger:"blur"}]}),Ve=C([]);L((()=>{we()}));const we=()=>{t.value=!0,setTimeout((()=>{Ve.value=l.value,t.value=!1}),500)},je=O((()=>{const e=a=>a.filter((a=>{var l,t,u;const n=(null==(l=o.name)?void 0:l.toLowerCase().trim())||"",r=(null==(t=o.route)?void 0:t.toLowerCase().trim())||"",i=_((null==(u=a.meta)?void 0:u.title)||"").toLowerCase(),s=(a.path||"").toLowerCase(),d=!n||i.includes(n),m=!r||s.includes(r);if(a.children&&a.children.length>0){const l=e(a.children);if(l.length>0)return a.children=l,!0}return d&&m}));return e(Ve.value)})),Ce=C(!1),xe=C(),Le=O((()=>{const e="menu"===ye.value?"菜单":"权限";return Ce.value?`编辑${e}`:`新建${e}`})),Oe=(e,a)=>{Ae("menu",a,!0)},Ue=()=>{},Ie=()=>i(this,null,(function*(){xe.value&&(yield xe.value.validate((e=>i(this,null,(function*(){if(e)try{Ce.value,ue.success((Ce.value?"编辑":"新增")+"成功"),ve.value=!1}catch(a){ue.error((Ce.value?"编辑":"新增")+"失败")}})))))})),Ae=(e,a,l=!1)=>{ve.value=!0,ye.value=e,Ce.value=!1,Pe.value=l,Ee(),a&&(Ce.value=!0,ne((()=>{"menu"===e?(_e.name=_(a.meta.title),_e.path=a.path,_e.label=a.name,_e.icon=a.meta.icon,_e.sort=a.meta.sort||1,_e.isMenu=a.meta.isMenu,_e.keepAlive=a.meta.keepAlive,_e.isHidden=a.meta.isHidden||!0,_e.isEnable=a.meta.isEnable||!0,_e.link=a.meta.link,_e.isIframe=a.meta.isIframe||!1):(_e.authName=a.title,_e.authLabel=a.auth_mark,_e.authIcon=a.icon||"",_e.authSort=a.sort||1)})))},Ee=()=>{var e;null==(e=xe.value)||e.resetFields(),Object.assign(_e,{name:"",path:"",label:"",icon:"",sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1})},Te=()=>i(this,null,(function*(){try{yield se.confirm("确定要删除该菜单吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),ue.success("删除成功")}catch(e){"cancel"!==e&&ue.error("删除失败")}})),He=()=>i(this,null,(function*(){try{yield se.confirm("确定要删除该权限吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),ue.success("删除成功")}catch(e){"cancel"!==e&&ue.error("删除失败")}})),Ne=O((()=>!(!Ce.value||"button"!==ye.value)||!(!Ce.value||"menu"!==ye.value)||!(Ce.value||"menu"!==ye.value||!Pe.value))),Pe=C(!1),Se=C(!1),Be=C(),Me=()=>{Se.value=!Se.value,ne((()=>{Be.value&&Be.value[Se.value?"expandAll":"collapseAll"]()}))};return(e,a)=>{const l=d,u=m,o=J,r=k,i=Q,s=Z,c=X,f=ae,b=ee,v=Y,_=y,V=le,w=te,C=$,x=W,L=S,O=p,ue=U("auth"),ne=U("ripple");return A(),I(O,null,{default:E((()=>[T("div",me,[H(l,{filter:P(n),"onUpdate:filter":a[0]||(a[0]=e=>N(n)?n.value=e:null),items:j,showExpand:!1,onReset:h,onSearch:g},null,8,["filter"]),H(L,{shadow:"never",class:"art-table-card"},{default:E((()=>[H(u,{showZebra:!1,columns:P(fe),"onUpdate:columns":a[2]||(a[2]=e=>N(fe)?fe.value=e:null),onRefresh:be},{left:E((()=>[B((A(),I(P(M),{onClick:a[1]||(a[1]=e=>Ae("menu",null,!0))},{default:E((()=>a[20]||(a[20]=[D(" 添加菜单 ")]))),_:1,__:[20]})),[[ue,"add"],[ne]]),B((A(),I(P(M),{onClick:Me},{default:E((()=>[D(q(P(Se)?"收起":"展开"),1)])),_:1})),[[ne]])])),_:1},8,["columns"]),H(r,{rowKey:"path",ref_key:"tableRef",ref:Be,loading:P(t),data:P(je),marginTop:10,stripe:!1},{default:E((()=>[(A(!0),R(z,null,F(P(he),(e=>(A(),I(o,K({key:e.prop||e.type},{ref_for:!0},e),null,16)))),128))])),_:1},8,["loading","data"]),H(x,{title:P(Le),modelValue:P(ve),"onUpdate:modelValue":a[19]||(a[19]=e=>N(ve)?ve.value=e:null),width:"700px","align-center":""},{footer:E((()=>[T("span",pe,[H(P(M),{onClick:a[17]||(a[17]=e=>ve.value=!1)},{default:E((()=>a[23]||(a[23]=[D("取 消")]))),_:1,__:[23]}),H(P(M),{type:"primary",onClick:a[18]||(a[18]=e=>Ie())},{default:E((()=>a[24]||(a[24]=[D("确 定")]))),_:1,__:[24]})])])),default:E((()=>[H(C,{ref_key:"formRef",ref:xe,model:P(_e),rules:P(ke),"label-width":"85px"},{default:E((()=>[H(c,{label:"菜单类型"},{default:E((()=>[H(s,{modelValue:P(ye),"onUpdate:modelValue":a[3]||(a[3]=e=>N(ye)?ye.value=e:null),disabled:P(Ne)},{default:E((()=>[H(i,{value:"menu",label:"menu"},{default:E((()=>a[21]||(a[21]=[D("菜单")]))),_:1,__:[21]}),H(i,{value:"button",label:"button"},{default:E((()=>a[22]||(a[22]=[D("权限")]))),_:1,__:[22]})])),_:1},8,["modelValue","disabled"])])),_:1}),"menu"===P(ye)?(A(),R(z,{key:0},[H(v,{gutter:20},{default:E((()=>[H(b,{span:12},{default:E((()=>[H(c,{label:"菜单名称",prop:"name"},{default:E((()=>[H(f,{modelValue:P(_e).name,"onUpdate:modelValue":a[4]||(a[4]=e=>P(_e).name=e),placeholder:"菜单名称"},null,8,["modelValue"])])),_:1})])),_:1}),H(b,{span:12},{default:E((()=>[H(c,{label:"路由地址",prop:"path"},{default:E((()=>[H(f,{modelValue:P(_e).path,"onUpdate:modelValue":a[5]||(a[5]=e=>P(_e).path=e),placeholder:"路由地址"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),H(v,{gutter:20},{default:E((()=>[H(b,{span:12},{default:E((()=>[H(c,{label:"权限标识",prop:"label"},{default:E((()=>[H(f,{modelValue:P(_e).label,"onUpdate:modelValue":a[6]||(a[6]=e=>P(_e).label=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1}),H(b,{span:12},{default:E((()=>[H(c,{label:"图标",prop:"icon"},{default:E((()=>[H(_,{modelValue:P(_e).icon,"onUpdate:modelValue":a[7]||(a[7]=e=>P(_e).icon=e),iconType:P(ge),width:"100%"},null,8,["modelValue","iconType"])])),_:1})])),_:1})])),_:1}),H(v,{gutter:20},{default:E((()=>[H(b,{span:12},{default:E((()=>[H(c,{label:"菜单排序",prop:"sort",style:{width:"100%"}},{default:E((()=>[H(V,{modelValue:P(_e).sort,"onUpdate:modelValue":a[8]||(a[8]=e=>P(_e).sort=e),style:{width:"100%"},onChange:Ue,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1}),H(b,{span:12},{default:E((()=>[H(c,{label:"外部链接",prop:"link"},{default:E((()=>[H(f,{modelValue:P(_e).link,"onUpdate:modelValue":a[9]||(a[9]=e=>P(_e).link=e),placeholder:"外部链接/内嵌地址(https://www.baidu.com)"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),H(v,{gutter:20},{default:E((()=>[H(b,{span:5},{default:E((()=>[H(c,{label:"是否启用",prop:"isEnable"},{default:E((()=>[H(w,{modelValue:P(_e).isEnable,"onUpdate:modelValue":a[10]||(a[10]=e=>P(_e).isEnable=e)},null,8,["modelValue"])])),_:1})])),_:1}),H(b,{span:5},{default:E((()=>[H(c,{label:"页面缓存",prop:"keepAlive"},{default:E((()=>[H(w,{modelValue:P(_e).keepAlive,"onUpdate:modelValue":a[11]||(a[11]=e=>P(_e).keepAlive=e)},null,8,["modelValue"])])),_:1})])),_:1}),H(b,{span:5},{default:E((()=>[H(c,{label:"是否显示",prop:"isHidden"},{default:E((()=>[H(w,{modelValue:P(_e).isHidden,"onUpdate:modelValue":a[12]||(a[12]=e=>P(_e).isHidden=e)},null,8,["modelValue"])])),_:1})])),_:1}),H(b,{span:5},{default:E((()=>[H(c,{label:"是否内嵌",prop:"isMenu"},{default:E((()=>[H(w,{modelValue:P(_e).isIframe,"onUpdate:modelValue":a[13]||(a[13]=e=>P(_e).isIframe=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):G("",!0),"button"===P(ye)?(A(),R(z,{key:1},[H(v,{gutter:20},{default:E((()=>[H(b,{span:12},{default:E((()=>[H(c,{label:"权限名称",prop:"authName"},{default:E((()=>[H(f,{modelValue:P(_e).authName,"onUpdate:modelValue":a[14]||(a[14]=e=>P(_e).authName=e),placeholder:"权限名称"},null,8,["modelValue"])])),_:1})])),_:1}),H(b,{span:12},{default:E((()=>[H(c,{label:"权限标识",prop:"authLabel"},{default:E((()=>[H(f,{modelValue:P(_e).authLabel,"onUpdate:modelValue":a[15]||(a[15]=e=>P(_e).authLabel=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),H(v,{gutter:20},{default:E((()=>[H(b,{span:12},{default:E((()=>[H(c,{label:"权限排序",prop:"authSort",style:{width:"100%"}},{default:E((()=>[H(V,{modelValue:P(_e).authSort,"onUpdate:modelValue":a[16]||(a[16]=e=>P(_e).authSort=e),style:{width:"100%"},onChange:Ue,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):G("",!0)])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])),_:1})])])),_:1})}}})))),[["__scopeId","data-v-06f658d9"]]);export{fe as default};
