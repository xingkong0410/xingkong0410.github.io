var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;import{_ as n,u as i,a as u,b as d,A as c,c as p,d as g,S as h,e as v,l as f,g as m,R as y,U as x,H as w,f as b}from"./index-CicZAoMs.js";/* empty css                    */import{k,a2 as _,aE as T,r as M,e as B,aF as L,c as P,m as $,t as I,z as V,F as O,u as R,p as S,v as j,T as E,G as C,s as U,x as D,y as A,av as X,M as F,a3 as H,l as N,C as z,D as G,at as q,I as K,J as Y,au as J,a4 as Q,ad as W,S as Z,ae as ee,L as ae,i as te,aG as se,O as le,P as oe,E as re,j as ne}from"./vendor-DaJLkETo.js";import{_ as ie}from"./LoginLeftView-U0-PSIOe.js";import"./lf_icon2-BooRsIsW.js";const ue=["innerHTML"],de=n(k({__name:"ArtDragVerify",props:{value:{type:Boolean,default:!1},width:{default:260},height:{default:38},text:{default:"按住滑块拖动"},successText:{default:"success"},background:{default:"#eee"},progressBarBg:{default:"#1385FF"},completedBg:{default:"#57D187"},circle:{type:Boolean,default:!1},radius:{default:"calc(var(--custom-radius) / 3 + 2px)"},handlerIcon:{default:"&#xea50;"},successIcon:{default:"&#xe621;"},handlerBg:{default:"#fff"},textSize:{default:"13px"},textColor:{default:"#333"}},emits:["handlerMove","update:value","passCallback"],setup(e,{expose:a,emit:t}){const s=t,l=e,o=_({isMoving:!1,x:0,isOk:!1}),{isOk:r}=T(o),n=M(),i=M(),u=M(),d=M();let c,p,g,h;const v=e=>{c=e.targetTouches[0].pageX,p=e.targetTouches[0].pageY},f=e=>{g=e.targetTouches[0].pageX,h=e.targetTouches[0].pageY,Math.abs(g-c)>Math.abs(h-p)&&e.preventDefault()};document.addEventListener("touchstart",v),document.addEventListener("touchmove",f,{passive:!1}),B((()=>{var e,a,t;null==(e=n.value)||e.style.setProperty("--textColor",l.textColor),null==(a=n.value)||a.style.setProperty("--width",Math.floor(l.width/2)+"px"),null==(t=n.value)||t.style.setProperty("--pwidth",-Math.floor(l.width/2)+"px"),document.addEventListener("touchstart",v),document.addEventListener("touchmove",f,{passive:!1})})),L((()=>{document.removeEventListener("touchstart",v),document.removeEventListener("touchmove",f)}));const m={left:"0",width:l.height+"px",height:l.height+"px",background:l.handlerBg},y={width:l.width+"px",height:l.height+"px",lineHeight:l.height+"px",background:l.background,borderRadius:l.circle?l.height/2+"px":l.radius},x={background:l.progressBarBg,height:l.height+"px",borderRadius:l.circle?l.height/2+"px 0 0 "+l.height/2+"px":l.radius},w={height:l.height+"px",width:l.width+"px",fontSize:l.textSize},b=P((()=>l.value?l.successText:l.text)),k=e=>{l.value||(o.isMoving=!0,u.value.style.transition="none",o.x=(e.pageX||e.touches[0].pageX)-parseInt(u.value.style.left.replace("px",""),10)),s("handlerMove")},U=e=>{if(o.isMoving&&!l.value){let a=(e.pageX||e.touches[0].pageX)-o.x;a>0&&a<=l.width-l.height?(u.value.style.left=a+"px",d.value.style.width=a+l.height/2+"px"):a>l.width-l.height&&(u.value.style.left=l.width-l.height+"px",d.value.style.width=l.width-l.height/2+"px",A())}},D=e=>{if(o.isMoving&&!l.value){(e.pageX||e.changedTouches[0].pageX)-o.x<l.width-l.height?(o.isOk=!0,u.value.style.left="0",u.value.style.transition="all 0.2s",d.value.style.width="0",o.isOk=!1):(u.value.style.transition="none",u.value.style.left=l.width-l.height+"px",d.value.style.width=l.width-l.height/2+"px",A()),o.isMoving=!1}},A=()=>{s("update:value",!0),o.isMoving=!1,d.value.style.background=l.completedBg,i.value.style["-webkit-text-fill-color"]="unset",i.value.style.animation="slidetounlock2 3s infinite",i.value.style.color="#fff",s("passCallback")};return a({reset:()=>{u.value.style.left="0",d.value.style.width="0",u.value.children[0].innerHTML=l.handlerIcon,i.value.style["-webkit-text-fill-color"]="transparent",i.value.style.animation="slidetounlock 3s infinite",i.value.style.color=l.background,s("update:value",!1),o.isOk=!1,o.isMoving=!1,o.x=0}}),(e,a)=>(I(),$("div",{ref_key:"dragVerify",ref:n,class:"drag_verify",style:y,onMousemove:U,onMouseup:D,onMouseleave:D,onTouchmove:U,onTouchend:D},[V("div",{class:O(["dv_progress_bar",{goFirst2:R(r)}]),ref_key:"progressBar",ref:d,style:x},null,2),V("div",{class:"dv_text",style:w,ref_key:"messageRef",ref:i},[e.$slots.textBefore?S(e.$slots,"textBefore",{key:0},void 0,!0):j("",!0),E(" "+C(R(b))+" ",1),e.$slots.textAfter?S(e.$slots,"textAfter",{key:1},void 0,!0):j("",!0)],512),V("div",{class:O(["dv_handler dv_handler_bg",{goFirst:R(r)}]),onMousedown:k,onTouchstart:k,ref_key:"handler",ref:u,style:m},[V("i",{class:"iconfont-sys",innerHTML:e.value?e.successIcon:e.handlerIcon},null,8,ue)],34)],544))}}),[["__scopeId","data-v-83557bea"]]),ce={class:"login"},pe={class:"right-wrap"},ge={class:"top-right-wrap"},he={class:"iconfont-sys"},ve={class:"menu-txt"},fe={key:0,class:"iconfont-sys icon-check"},me={class:"header"},ye={class:"login-wrap"},xe={class:"form"},we={class:"title"},be={class:"sub-title"},ke={class:"drag-verify"},_e={class:"forget-password"},Te={style:{"margin-top":"30px"}},Me={class:"footer"},Be=k((Le=((e,a)=>{for(var t in a||(a={}))l.call(a,t)&&r(e,t,a[t]);if(s)for(var t of s(a))o.call(a,t)&&r(e,t,a[t]);return e})({},{name:"Login"}),a(Le,t({__name:"index",setup(e){const{t:a}=i(),t=P((()=>[{key:"super",label:a("login.roles.super"),userName:"Super",password:"123456",roles:["R_SUPER"]},{key:"admin",label:a("login.roles.admin"),userName:"Admin",password:"123456",roles:["R_ADMIN"]},{key:"user",label:a("login.roles.user"),userName:"User",password:"123456",roles:["R_USER"]}])),s=u(),{isDark:l,systemThemeType:o}=U(s),r=M(),n=d(),k=N(),T=M(!1),L=M(!1),S=c.systemInfo.name,ue=M(),Be=_({account:"",username:"",password:"",rememberPassword:!0}),Le=P((()=>({username:[{required:!0,message:a("login.placeholder[0]"),trigger:"blur"}],password:[{required:!0,message:a("login.placeholder[1]"),trigger:"blur"}]}))),Pe=M(!1),{width:$e}=p();B((()=>{Ie("super")}));const Ie=e=>{var a,s;const l=t.value.find((a=>a.key===e));Be.account=e,Be.username=null!=(a=null==l?void 0:l.userName)?a:"",Be.password=null!=(s=null==l?void 0:l.password)?s:""},Ve=()=>{return e=this,a=null,t=function*(){if(ue.value)try{if(!(yield ue.value.validate()))return;if(!T.value)return void(L.value=!0);Pe.value=!0;const{username:e,password:a}=Be,{token:t,refreshToken:s}=yield x.login({userName:e,password:a});if(!t)throw new Error("Login failed - no token received");n.setToken(t,s);const l=yield x.getUserInfo();n.setUserInfo(l),n.setLoginStatus(!0),Re(),k.push(w)}catch(e){e instanceof b||re.error("登录失败，请稍后重试")}finally{Pe.value=!1,Oe()}},new Promise(((s,l)=>{var o=e=>{try{n(t.next(e))}catch(a){l(a)}},r=e=>{try{n(t.throw(e))}catch(a){l(a)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,r);n((t=t.apply(e,a)).next())}));var e,a,t},Oe=()=>{r.value.reset()},Re=()=>{setTimeout((()=>{ne({title:a("login.success.title"),type:"success",duration:2500,zIndex:1e4,message:`${a("login.success.message")}, ${S}!`})}),150)},{locale:Se}=i(),je=e=>{Se.value!==e&&(Se.value=e,n.setLanguage(e))},Ee=()=>{let{LIGHT:e,DARK:a}=h;v().switchThemeStyles(o.value===e?a:e)};return(e,a)=>{const s=ie,o=J,n=q,i=X,u=g,d=ee,c=W,p=Q,h=ae,v=de,x=se,w=z("RouterLink"),b=oe,k=H,_=G("ripple");return I(),$("div",ce,[D(s),V("div",pe,[V("div",ge,[V("div",{class:"btn theme-btn",onClick:Ee},[V("i",he,C(R(l)?"":""),1)]),D(i,{onCommand:je,"popper-class":"langDropDownStyle"},{dropdown:A((()=>[D(n,null,{default:A((()=>[(I(!0),$(K,null,Y(R(f),(e=>(I(),$("div",{key:e.value,class:"lang-btn-item"},[D(o,{command:e.value,class:O({"is-selected":R(Se)===e.value})},{default:A((()=>[V("span",ve,C(e.label),1),R(Se)===e.value?(I(),$("i",fe,"")):j("",!0)])),_:2},1032,["command","class"])])))),128))])),_:1})])),default:A((()=>[a[5]||(a[5]=V("div",{class:"btn language-btn"},[V("i",{class:"iconfont-sys icon-language"},"")],-1))])),_:1,__:[5]})]),V("div",me,[D(u,{class:"icon"}),V("h1",null,C(R(S)),1)]),V("div",ye,[V("div",xe,[V("h3",we,C(e.$t("login.title")),1),V("p",be,C(e.$t("login.subTitle")),1),D(k,{ref_key:"formRef",ref:ue,model:R(Be),rules:R(Le),onKeyup:F(Ve,["enter"]),style:{"margin-top":"25px"}},{default:A((()=>[D(p,{prop:"account"},{default:A((()=>[D(c,{modelValue:R(Be).account,"onUpdate:modelValue":a[0]||(a[0]=e=>R(Be).account=e),onChange:Ie,class:"account-select"},{default:A((()=>[(I(!0),$(K,null,Y(R(t),(e=>(I(),Z(d,{key:e.key,label:e.label,value:e.key},{default:A((()=>[V("span",null,C(e.label),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),D(p,{prop:"username"},{default:A((()=>[D(h,{placeholder:e.$t("login.placeholder[0]"),modelValue:R(Be).username,"onUpdate:modelValue":a[1]||(a[1]=e=>R(Be).username=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])])),_:1}),D(p,{prop:"password"},{default:A((()=>[D(h,{placeholder:e.$t("login.placeholder[1]"),modelValue:R(Be).password,"onUpdate:modelValue":a[2]||(a[2]=e=>R(Be).password=e),modelModifiers:{trim:!0},type:"password",radius:"8px",autocomplete:"off","show-password":""},null,8,["placeholder","modelValue"])])),_:1}),V("div",ke,[V("div",{class:O(["drag-verify-content",{error:!R(T)&&R(L)}])},[D(v,{ref_key:"dragVerify",ref:r,value:R(T),"onUpdate:value":a[3]||(a[3]=e=>te(T)?T.value=e:null),width:R($e)<500?328:438,text:e.$t("login.sliderText"),textColor:"var(--art-gray-800)",successText:e.$t("login.sliderSuccessText"),progressBarBg:R(m)("--el-color-primary"),background:"var(--art-gray-200)",handlerBg:"var(--art-main-bg-color)"},null,8,["value","width","text","successText","progressBarBg"])],2),V("p",{class:O(["error-text",{"show-error-text":!R(T)&&R(L)}])},C(e.$t("login.placeholder[2]")),3)]),V("div",_e,[D(x,{modelValue:R(Be).rememberPassword,"onUpdate:modelValue":a[4]||(a[4]=e=>R(Be).rememberPassword=e)},{default:A((()=>[E(C(e.$t("login.rememberPwd")),1)])),_:1},8,["modelValue"]),D(w,{to:R(y).ForgetPassword},{default:A((()=>[E(C(e.$t("login.forgetPwd")),1)])),_:1},8,["to"])]),V("div",Te,[le((I(),Z(b,{class:"login-btn",type:"primary",onClick:Ve,loading:R(Pe)},{default:A((()=>[E(C(e.$t("login.btnText")),1)])),_:1},8,["loading"])),[[_]])]),V("div",Me,[V("p",null,[E(C(e.$t("login.noAccount"))+" ",1),D(w,{to:R(y).Register},{default:A((()=>[E(C(e.$t("login.register")),1)])),_:1},8,["to"])])])])),_:1},8,["model","rules"])])])])])}}}))));var Le;const Pe=n(Be,[["__scopeId","data-v-b7d284c8"]]);export{Pe as default};
