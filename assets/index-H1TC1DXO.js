var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,u=(e,a,l)=>new Promise(((t,s)=>{var o=e=>{try{u(l.next(e))}catch(a){s(a)}},r=e=>{try{u(l.throw(e))}catch(a){s(a)}},u=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,r);u((l=l.apply(e,a)).next())}));import{b as n,i,n as d,k as c,o as p,m,_ as v}from"./index-CicZAoMs.js";/* empty css                  *//* empty css                    */import{_ as f}from"./ArtWangEditor.vue_vue_type_style_index_0_lang-DGOwDNnI.js";/* empty css               *//* empty css               */import{k as y,al as h,r as _,e as b,m as g,t as j,z as w,x,y as V,aJ as k,L as P,i as E,u as O,ad as A,I as q,J as M,S as T,ae as U,aL as Y,a4 as z,aR as D,H as I,aS as S,ab as J,a3 as L,T as W,G as $,P as B,E as C}from"./vendor-DaJLkETo.js";import{E as G}from"./emojo-Ben6gd8J.js";import{P as H}from"./formEnum-BLgiZVxV.js";const N={class:"article-edit"},R={class:"editor-wrap"},F={class:"form-wrap"},K={class:"el-top upload-container"},Q={key:0,class:"upload-placeholder"},X=["src"],Z={style:{display:"flex","justify-content":"flex-end"}},ee=y((ae=((e,a)=>{for(var l in a||(a={}))s.call(a,l)&&r(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&r(e,l,a[l]);return e})({},{name:"ArticlePublish"}),a(ae,l({__name:"index",setup(e){const a=h(),l=n();let{accessToken:t}=l;const s={Authorization:t};let o=H.Add;const r=_(""),v=_(),y=_(),ee=_(""),ae=_(""),le=_(""),te=_(!0);b((()=>{i().scrollToTop(),ue(),se()}));const se=()=>{const{id:e}=a.query;o=e?H.Edit:H.Add,o===H.Edit&&e?oe():re()},oe=()=>{ne()},re=()=>{ae.value=de(d().value)},ue=()=>u(this,null,(function*(){try{const e=yield c.get("https://www.qiniu.lingchen.kim/classify.json");200===e.data.code&&(y.value=e.data.data)}catch(e){}})),ne=()=>u(this,null,(function*(){const e=yield c.get("https://www.qiniu.lingchen.kim/blog_list.json");if(e.data.code===p.success){let{title:a,blog_class:l,html_content:t}=e.data.data;r.value=a,v.value=Number(l),ee.value=t}})),ie=()=>{o===H.Edit?me():pe()},de=e=>m(e,"YYYY-MM-DD").value,ce=()=>r.value?v.value?"<p><br></p>"===ee.value?(C.error("请输入文章内容"),!1):!!le.value||(C.error("请上传图片"),!1):(C.error("请选择文章类型"),!1):(C.error("请输入文章标题"),!1),pe=()=>u(this,null,(function*(){try{if(!ce())return;ee.value=ve(ee.value)}catch(e){}})),me=()=>u(this,null,(function*(){try{if(!ce())return;ee.value=ve(ee.value)}catch(e){}})),ve=e=>e.replace(/(\s*)<\/code>/g,"</code>"),fe=e=>{le.value=e.data.url,C.success(`图片上传成功 ${G[200]}`)},ye=()=>{C.error(`图片上传失败 ${G[500]}`)},he=e=>{const a=e.type.startsWith("image/"),l=e.size/1024/1024<2;return a?!!l||(C.error("图片大小不能超过 2MB!"),!1):(C.error("只能上传图片文件!"),!1)};return(e,a)=>{const l=P,t=k,u=U,n=A,i=Y,d=f,c=I,p=D,m=z,h=J,_=L,b=B;return j(),g("div",N,[w("div",null,[w("div",R,[x(i,{gutter:10},{default:V((()=>[x(t,{span:18},{default:V((()=>[x(l,{modelValue:O(r),"onUpdate:modelValue":a[0]||(a[0]=e=>E(r)?r.value=e:null),modelModifiers:{trim:!0},placeholder:"请输入文章标题（最多100个字符）",maxlength:"100"},null,8,["modelValue"])])),_:1}),x(t,{span:6},{default:V((()=>[x(n,{modelValue:O(v),"onUpdate:modelValue":a[1]||(a[1]=e=>E(v)?v.value=e:null),placeholder:"请选择文章类型",filterable:""},{default:V((()=>[(j(!0),g(q,null,M(O(y),(e=>(j(),T(u,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),x(d,{class:"el-top",modelValue:O(ee),"onUpdate:modelValue":a[2]||(a[2]=e=>E(ee)?ee.value=e:null)},null,8,["modelValue"]),w("div",F,[a[6]||(a[6]=w("h2",null,"发布设置",-1)),x(_,null,{default:V((()=>[x(m,{label:"封面"},{default:V((()=>[w("div",K,[x(p,{class:"cover-uploader",action:"https://m1.apifoxmock.com/m1/6400575-6097373-default/api/common/upload",headers:s,"show-file-list":!1,"on-success":fe,"on-error":ye,"before-upload":he},{default:V((()=>[O(le)?(j(),g("img",{key:1,src:O(le),class:"cover-image"},null,8,X)):(j(),g("div",Q,[x(c,{class:"upload-icon"},{default:V((()=>[x(O(S))])),_:1}),a[4]||(a[4]=w("div",{class:"upload-text"},"点击上传封面",-1))]))])),_:1}),a[5]||(a[5]=w("div",{class:"el-upload__tip"},"建议尺寸 16:9，jpg/png 格式",-1))])])),_:1}),x(m,{label:"可见"},{default:V((()=>[x(h,{modelValue:O(te),"onUpdate:modelValue":a[3]||(a[3]=e=>E(te)?te.value=e:null)},null,8,["modelValue"])])),_:1})])),_:1}),w("div",Z,[x(b,{type:"primary",onClick:ie,style:{width:"100px"}},{default:V((()=>[W($(O(o)===O(H).Edit?"保存":"发布"),1)])),_:1})])])])])])}}}))));var ae;const le=v(ee,[["__scopeId","data-v-844204ed"]]);export{le as default};
